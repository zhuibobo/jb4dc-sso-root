<!DOCTYPE html><html lang="zh" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"><head><meta charset="UTF-8"><title>Title</title><title>JBuild4D</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><script type="text/javascript" src="../../../Js/External/JQuery-3.4.1/jquery-3.4.1.min.js"></script><script type="text/javascript" src="../../../Js/External/VUE-2.6.10/vue.js"></script><script type="text/javascript" src="../../../Js/External/IView-3.X/dist/iview.min.js"></script><script type="text/javascript" src="../../../Js/External/JQuery-UI-1.12.1/jquery-ui.js"></script><script type="text/javascript" src="../../../Js/External/ZTree-3.5.40/js/jquery.ztree.all.js"></script><script type="text/javascript" src="../../../Js/JBuild4DCLib.js?refVersion=1"></script><script type="text/javascript" src="../../../Js/UIEXComponent.js?refVersion=1"></script><script type="text/javascript" src="../../../Js/VueEXComponent.js?refVersion=1"></script><script type="text/javascript" src="../../../Js/SSOVueEXComponent.js?refVersion=1"></script><script type="text/javascript" src="../../../Js/External/ZTree-3.5.40/js/jquery.ztree.exhide.js"></script><script type="text/javascript" src="../../../Js/External/ZTree-3.5.40/js/fuzzysearch.js"></script><link rel="stylesheet" type="text/css" href="../../../Themes/Default/Css/JBuild4DC.css?refVersion=1"><link rel="stylesheet" type="text/css" href="../../../Themes/Default/IView-3.X/iview.css"><link rel="stylesheet" type="text/css" href="../../../Themes/Default/JQueryUI/jquery-ui.css"><link rel="stylesheet" type="text/css" href="../../../Themes/Default/JQueryUI/jquery-ui-important.css"><link rel="stylesheet" type="text/css" href="../../../Themes/Default/ZTree/zTreeStyle/zTreeStyle.css"></head><body><div id="appList" class="list-2column"><div class="left-outer-wrap"><div class="inner-wrap" style="width:250px"><div class="tool-bar-wrap"></div><div><ul id="zTreeUL" class="ztree"></ul></div></div></div><div class="right-outer-wrap" style="padding:10px;left:260px"><div style="width:100%"><div style="float:right;margin-bottom:15px;margin-top:10px;margin-right:10px"><button-group><i-button type="success" @click="add()" icon="md-add">新增</i-button><i-button type="primary" @click="edit()" icon="md-create">修改</i-button><i-button type="primary" @click="del()" icon="md-close">删除</i-button><i-button type="primary" @click="view()" icon="md-search">浏览</i-button><i-button type="primary" @click="view()" icon="md-search">迁移</i-button><i-button type="primary" @click="move('up')" icon="md-arrow-up">上移</i-button><i-button type="primary" @click="move('down')" icon="md-arrow-down">下移</i-button></button-group></div></div><div id="divTreeTable" style="width:98%;margin:auto"></div></div></div><script>var treeTableObj=null,appList=new Vue({el:"#appList",mounted:function(){this.initTree()},data:{acInterface:{getSystemTreeData:"/Rest/SSO/App/Application/GetAllMainSsoApp",menuEditView:"/HTML/SSO/Menu/MenuEdit.html",getMenusDataBySystemId:"/Rest/SSO/Mu/Menu/GetMenusBySystemId",deleteMenu:"/Rest/SystemSetting/Dict/Dictionary/Delete",statusChange:"/Rest/SystemSetting/Dict/Dictionary/StatusChange",setSelected:"/Rest/SystemSetting/Dict/Dictionary/SetSelected",move:"/Rest/SystemSetting/Dict/Dictionary/Move"},treeObj:null,treeSelectedNode:null,tableTreeRootData:{id:"-1",text:"数据关联",parentId:"",nodeTypeName:"根节点",icon:"../../../Themes/Png16X16/coins_add.png",_nodeExType:"root",tableId:"-1"},treeSetting:{view:{dblClickExpand:!1,showLine:!0,fontCss:{color:"black","font-weight":"normal"}},check:{enable:!1,nocheckInherit:!1,radioType:"all"},data:{key:{name:"appName"},simpleData:{enable:!0,idKey:"appId",pIdKey:"appMainId",rootId:0}},callback:{onClick:function(e,t,i){appList.treeSelectedNode=i,appList.reloadTreeTableData()},onAsyncSuccess:function(e,t,i,l){appList.treeObj.expandAll(!0)}}},treeTableObject:null,treeTableConfig:{CanDeleteWhenHasChild:!1,IdField:"menuId",RowIdPrefix:"TreeTable_",LoadChildJsonURL:"",LoadChildFunc:null,OpenLevel:2,ChildTestField:"menuChildCount",Templates:[{Title:"名称",FieldName:"menuName",TitleCellClassName:"TitleCell",Renderer:"Lable",Hidden:!1,TitleCellAttrs:{},Width:"20%"},{Title:"链接地址",FieldName:"menuRightUrl",TitleCellClassName:"TitleCell",Renderer:"Lable",Hidden:!1,TitleCellAttrs:{},Width:"40%",TextAlign:"center"},{Title:"备注",FieldName:"menuDescription",TitleCellClassName:"TitleCell",Renderer:"Lable",Hidden:!1,TitleCellAttrs:{},Width:"20%",TextAlign:"center"},{Title:"菜单值",FieldName:"menuValue",TitleCellClassName:"TitleCell",Renderer:"Lable",Hidden:!1,TitleCellAttrs:{},Width:"20%",TextAlign:"center"}],TableClass:"TreeTable",RendererTo:"divTreeTable",TableId:"TreeTable",TableAttrs:{cellpadding:"0",cellspacing:"0",border:"0"}}},methods:{initTree:function(){AjaxUtility.Post(this.acInterface.getSystemTreeData,{},function(e){if(e.success){for(var t=e.data,i=0;i<t.length;i++)t[i].icon="../../../Themes/Png16X16/computer-link.png";this.treeObj=$.fn.zTree.init($("#zTreeUL"),this.treeSetting,t),this.treeObj.expandAll(!0),this.treeObj._host=this}},this)},reloadTreeTableData:function(){var i=this,e={systemId:this.treeSelectedNode.appId};AjaxUtility.Post(this.acInterface.getMenusDataBySystemId,e,function(e){if(e.success){console.log(e),null==e.data&&(e.data=new Array),e.data.push({menuId:"0",menuParentId:"-1",menuName:this.treeSelectedNode.appName,menuValue:"Root",menuRightUrl:"",menuDescription:""});var t=JsonUtility.ParseArrayJsonToTreeJson({KeyField:"menuId",RelationField:"menuParentId",ChildFieldName:"Nodes"},e.data,"0");$("#divTreeTable").html(""),this.treeTableObject=Object.create(TreeTable),this.treeTableObject.Initialization(i.treeTableConfig),this.treeTableObject.LoadJsonData(t)}},this)},mareSureSelectedTreeTableRow:function(e){if(null==this.treeTableObject)return DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"请先选定分组!",null),{then:function(e){}};var t=this.treeTableObject.GetSelectedRowData();return null==t?(DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"请选择需要"+e+"的字典!",null),{then:function(e){}}):t.dictId==this.treeSelectedNode.dictGroupId?(DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"不能编辑根节点!",null),{then:function(e){}}):{then:function(e){e.call(appList,t)}}},add:function(){DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"未实现",null,this)},edit:function(){DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"未实现",null,this)},del:function(){DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"未实现",null,this)},view:function(){DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"未实现",null,this)},move:function(e){DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"未实现",null,this)},newTreeTableNode:function(e,t,i,l,a,n,d,o){var r={dictId:e,dictKey:t,dictValue:i,dictText:l,dictGroupId:a,dictCreateTime:n,dictStatus:d,dictIsSelected:o};this.treeTableObject.AppendChildRowToCurrentSelectedRow(r)},updateTreeTableNode:function(e,t,i,l,a,n){var d={dictId:e,dictKey:t,dictValue:i,dictText:l,dictStatus:a,dictIsSelected:n};this.treeTableObject.UpdateToRow(e,d)}}})</script></body></html>