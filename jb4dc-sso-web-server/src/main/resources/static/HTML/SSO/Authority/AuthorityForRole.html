<!DOCTYPE html><html lang="zh" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"><head><meta charset="UTF-8"><title>Title</title><title>JBuild4D</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><script type="text/javascript" src="../../../Js/External/JQuery-3.4.1/jquery-3.4.1.min.js"></script><script type="text/javascript" src="../../../Js/External/VUE-2.6.10/vue.js"></script><script type="text/javascript" src="../../../Js/External/IView-3.X/dist/iview.min.js"></script><script type="text/javascript" src="../../../Js/External/JQuery-UI-1.12.1/jquery-ui.js"></script><script type="text/javascript" src="../../../Js/External/ZTree-3.5.40/js/jquery.ztree.all.js"></script><script type="text/javascript" src="../../../Js/JBuild4DCLib.js?refVersion=1"></script><script type="text/javascript" src="../../../Js/UIEXComponent.js?refVersion=1"></script><script type="text/javascript" src="../../../Js/VueEXComponent.js?refVersion=1"></script><script type="text/javascript" src="../../../Js/SSOVueEXComponent.js?refVersion=1"></script><link rel="stylesheet" type="text/css" href="../../../Themes/Default/Css/JBuild4DC.css?refVersion=1"><link rel="stylesheet" type="text/css" href="../../../Themes/Default/IView-3.X/iview.css"><link rel="stylesheet" type="text/css" href="../../../Themes/Default/JQueryUI/jquery-ui.css"><link rel="stylesheet" type="text/css" href="../../../Themes/Default/JQueryUI/jquery-ui-important.css"><link rel="stylesheet" type="text/css" href="../../../Themes/Default/ZTree/zTreeStyle/zTreeStyle.css"><script type="text/javascript" src="../../../Js/External/ZTree-3.5.40/js/jquery.ztree.exhide.js"></script><script type="text/javascript" src="../../../Js/External/ZTree-3.5.40/js/fuzzysearch.js"></script></head><body><div id="appForm" class="general-edit-page-wrap" style="margin-top:0" v-cloak><tabs><tab-pane label="系统&菜单"><div class="list-2column" style="height:430px"><div class="left-outer-wrap"><div class="inner-wrap" style="width:250px"><div><ul id="zSystemTreeUL" class="ztree"></ul></div></div></div><div class="right-outer-wrap" style="padding:10px;left:260px"><div id="divTreeTable" style="width:98%;margin:auto"><ul id="zMenuTreeUL" class="ztree"></ul></div></div></div></tab-pane><tab-pane label="操作权限"></tab-pane></tabs><div class="button-outer-wrap"><div class="button-inner-wrap"><button-group><i-button type="primary" @click="handleSubmit()" icon="md-checkmark">保存</i-button><i-button @click="handleClose()" icon="md-close">关闭</i-button></button-group></div></div></div><script>var appForm=new Vue({el:"#appForm",mounted:function(){this.initSystemTree()},data:{acInterface:{getSystemTreeData:"/Rest/SSO/App/Application/GetAllMainSsoApp",getMenusDataBySystemId:"/Rest/SSO/Mu/Menu/GetMenusBySystemId"},systemTree:{treeObj:null,treeSelectedNode:null,treeSetting:{view:{dblClickExpand:!1,showLine:!0,fontCss:{color:"black","font-weight":"normal"}},check:{enable:!0,nocheckInherit:!1,radioType:"all"},data:{key:{name:"appName"},simpleData:{enable:!0,idKey:"appId",pIdKey:"appMainId",rootId:0}},callback:{onClick:function(e,t,n){appForm.systemTree.treeSelectedNode=n,appForm.reloadMenuTreeData()},onAsyncSuccess:function(e,t,n,a){appList.treeObj.expandAll(!0)}}}},menuTree:{treeObj:null,treeSelectedNode:null,treeSetting:{view:{dblClickExpand:!1,showLine:!0,fontCss:{color:"black","font-weight":"normal"}},check:{enable:!0,nocheckInherit:!0,radioType:"all"},data:{key:{name:"menuName"},simpleData:{enable:!0,idKey:"menuId",pIdKey:"menuParentId",rootId:0}},callback:{onClick:function(e,t,n){appForm.systemTree.treeSelectedNode=n,appForm.reloadMenuTreeData()},onAsyncSuccess:function(e,t,n,a){appList.treeObj.expandAll(!0)}}}}},methods:{initSystemTree:function(){AjaxUtility.Post(this.acInterface.getSystemTreeData,{},function(e){if(e.success){for(var t=e.data,n=0;n<t.length;n++)t[n].icon="../../../Themes/Png16X16/computer-link.png";this.systemTree.treeObj=$.fn.zTree.init($("#zSystemTreeUL"),this.systemTree.treeSetting,t),this.systemTree.treeObj.expandAll(!0),this.systemTree.treeObj._host=this}},this)},reloadMenuTreeData:function(){AjaxUtility.Post(this.acInterface.getMenusDataBySystemId,{systemId:this.systemTree.treeSelectedNode.appId},function(e){if(e.success){var t=e.data;console.log(t);for(var n=0;n<t.length;n++)t[n].icon="../../../Themes/Png16X16/document_letter_okay.png";this.menuTree.treeObj=$.fn.zTree.init($("#zMenuTreeUL"),this.menuTree.treeSetting,t),this.menuTree.treeObj.expandAll(!0),this.menuTree.treeObj._host=this}},this)},handleSubmit:function(){var t=this,e={ssoAppEntity:this.$refs.mainAppDetailFromComp.getAppEntity(),ssoAppInterfaceEntityList:this.$refs.mainAppInterfaceListComp.getInterfaceListData()},n=JSON.stringify(e);AjaxUtility.PostRequestBody(this.acInterface.saveMainAppUrl,n,function(e){e.success?DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,function(){window.OpenerWindowObj.appList.reloadData(),t.handleClose()}):DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,null)},this)},handleClose:function(){DialogUtility.Frame_CloseDialog(window)}}})</script></body></html>