<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">
    <!--单点登录模块-->
    <changeSet author="zhuangrb" id="changeSet-SSO-0001" objectQuotingStrategy="QUOTE_ALL_OBJECTS">
        <createTable tableName="TSSO_ORGAN_TYPE" remarks="组织机构类型">
            <column name="ORGAN_TYPE_ID" type="NVARCHAR(100)" remarks="组织机构类型ID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ORGAN_TYPE_VALUE" type="NVARCHAR(300)" remarks="组织机构编码值:唯一,与组织机构表关联">
                <constraints nullable="false"/>
            </column>
            <column name="ORGAN_TYPE_NAME" type="NVARCHAR(300)" remarks="组织机构类型名称">
                <constraints nullable="false"/>
            </column>
            <column name="ORGAN_TYPE_DESC" type="NVARCHAR(2000)" remarks="组织机构类型备注" />
            <column name="ORGAN_TYPE_ORDER_NUM" type="INT" remarks="排序号" />
            <column name="ORGAN_TYPE_STATUS" type="NVARCHAR(10)" remarks="状态:启用,禁用" />
            <column name="ORGAN_TYPE_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
        </createTable>

        <createTable tableName="TSSO_ORGAN" remarks="组织机构表">
            <column name="ORGAN_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ORGAN_NAME" type="NVARCHAR(300)" remarks="组织机构名称">
                <constraints nullable="false"/>
            </column>
            <column name="ORGAN_SHORT_NAME" type="NVARCHAR(150)" remarks="组织机构简称" />
            <column name="ORGAN_NO" type="NVARCHAR(200)" remarks="组织机构编号" />
            <column name="ORGAN_CODE" type="NVARCHAR(200)" remarks="组织机构代码" />
            <column name="ORGAN_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="ORGAN_PHONE" type="NVARCHAR(100)" remarks="联系电话" />
            <column name="ORGAN_POST" type="NVARCHAR(20)" remarks="邮政编码" />
            <column name="ORGAN_TYPE_VALUE" type="NVARCHAR(50)" remarks="组织机构类型:关联TSSO_ORGAN_TYPE表"/>
            <column name="ORGAN_ADDRESS" type="NVARCHAR(1000)" remarks="组织机构地址" />
            <column name="ORGAN_CONTACTS" type="NVARCHAR(100)" remarks="联系人" />
            <column name="ORGAN_CONTACTS_MOBILE" type="NVARCHAR(100)" remarks="联系人电话" />
            <column name="ORGAN_WEB_SITE" type="NVARCHAR(300)" remarks="站点地址" />
            <column name="ORGAN_FAX" type="NVARCHAR(100)" remarks="传真号码" />
            <column name="ORGAN_CHILD_COUNT" type="INT" remarks="子节点数量" />
            <column name="ORGAN_IS_VIRTUAL" type="NVARCHAR(10)" remarks="是否虚拟" />
            <column name="ORGAN_ORDER_NUM" type="INT" remarks="排序号" />
            <column name="ORGAN_PARENT_ID" type="NVARCHAR(100)" remarks="父节点ID" />
            <column name="ORGAN_PARENT_ID_LIST" type="NVARCHAR(1200)" remarks="父节点列表" />
            <column name="ORGAN_STATUS" type="NVARCHAR(10)" remarks="状态:启用,禁用" />
            <column name="ORGAN_CREATER_ORG_ID" type="NVARCHAR(100)" remarks="创建组织者ID"/>
            <column name="ORGAN_MAIN_IMAGE_ID" remarks="主题Logo:关联到TFS_FILE_INFO表的FILE_ID" type="NVARCHAR(100)"/>
            <column name="ORGAN_DESC" type="NVARCHAR(2000)" remarks="组织机构备注" />
        </createTable>

        <createTable tableName="TSSO_DEPARTMENT" remarks="组织内部部门表">
            <column name="DEPT_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="DEPT_NAME" type="NVARCHAR(150)" remarks="部门名称" />
            <column name="DEPT_SHORT_NAME" type="NVARCHAR(150)" remarks="部门简称" />
            <column name="DEPT_NO" type="NVARCHAR(200)" remarks="部门编号" />
            <column name="DEPT_PER_CHARGE" type="NVARCHAR(50)" remarks="部门负责人" />
            <column name="DEPT_PER_CHARGE_PHONE" type="NVARCHAR(50)" remarks="部门负责人电话" />
            <column name="DEPT_IS_VIRTUAL" type="NVARCHAR(10)" remarks="是否虚拟" />
            <column name="DEPT_CHILD_COUNT" type="INT" remarks="子节点数量" />
            <column name="DEPT_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="DEPT_CREATE_USER_ID" type="NVARCHAR(100)" remarks="创建用户ID" />
            <column name="DEPT_ORDER_NUM" type="INT" remarks="排序号" />
            <column name="DEPT_IS_ROOT" type="NVARCHAR(10)" remarks="是否根节点:根节点在组织创建时自动创建" />
            <column name="DEPT_PARENT_ID" type="NVARCHAR(100)" remarks="父节点ID:根节点的ParentId为0" />
            <column name="DEPT_PARENT_ID_LIST" type="NVARCHAR(1200)" remarks="父节点列表" />
            <column name="DEPT_STATUS" type="NVARCHAR(10)" remarks="状态:启用,禁用" />
            <column name="DEPT_ORGAN_ID" type="NVARCHAR(100)" remarks="所属组织ID" />
            <column name="DEPT_DESC" type="NVARCHAR(2000)" remarks="部门备注" />
        </createTable>

        <createTable tableName="TSSO_DEPARTMENT_USER" remarks="部门与用户关联表">
            <column name="DU_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="DU_DEPT_ID" type="NVARCHAR(100)" remarks="部门ID"/>
            <column name="DU_USER_ID" type="NVARCHAR(100)" remarks="用户ID"/>
            <column name="DU_IS_MAIN" type="NVARCHAR(100)" remarks="是否主属"/>
            <column name="DU_TITLE" type="NVARCHAR(100)" remarks="部门用户职位"/>
            <column name="DU_DESC" type="NVARCHAR(2000)" remarks="部门用户备注"/>
            <column name="DU_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="DU_CREATE_USER_ID" type="NVARCHAR(100)" remarks="创建用户ID" />
            <column name="DU_STATUS" type="NVARCHAR(10)" remarks="状态:启用,禁用" />
            <column name="DU_ORDER_NUM" type="INT" remarks="排序号" />
        </createTable>

        <createTable tableName="TSSO_USER" remarks="用户信息表">
            <column name="USER_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="USER_NAME" type="NVARCHAR(100)" remarks="用户名"/>
            <column name="USER_ACCOUNT" type="NVARCHAR(100)" remarks="账号"/>
            <column name="USER_PASSWORD" type="NVARCHAR(100)" remarks="密码"/>
            <column name="USER_EMAIL" type="NVARCHAR(100)" remarks="邮件地址"/>
            <column name="USER_PHONE_NUMBER" type="NVARCHAR(100)" remarks="手机号码"/>
            <column name="USER_HEAD_ID" remarks="头像ID:关联到TFS_FILE_INFO表的FILE_ID" type="NVARCHAR(100)"/>
            <column name="USER_ORGAN_ID" type="NVARCHAR(100)" remarks="所属组织ID" />
            <column name="USER_DESC" type="NVARCHAR(2000)" remarks="用户备注"/>
            <column name="USER_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="USER_CREATE_USER_ID" type="NVARCHAR(100)" remarks="创建用户ID" />
            <column name="USER_STATUS" type="NVARCHAR(10)" remarks="状态:启用,禁用" />
            <column name="USER_ORDER_NUM" type="INT" remarks="排序号" />
            <column name="USER_TYPE" type="NVARCHAR(30)" remarks="用户类型:平台管理员,组织机构管理员,一般用户" />
        </createTable>

        <createTable tableName="TSSO_ROLE_GROUP" remarks="角色组表">
            <column name="ROLE_GROUP_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ROLE_GROUP_NAME" type="NVARCHAR(100)" remarks="角色组名称"/>
            <column name="ROLE_GROUP_ORDER_NUM" type="INT" remarks="排序号" />
            <column name="ROLE_GROUP_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="ROLE_GROUP_DESC" type="NVARCHAR(500)" remarks="备注" />
            <column name="ROLE_GROUP_STATUS" type="NVARCHAR(10)" remarks="状态" />
            <column name="ROLE_GROUP_PARENT_ID" type="NVARCHAR(100)" remarks="父节点ID" />
            <column name="ROLE_GROUP_ISSYSTEM" type="NVARCHAR(10)" remarks="是否系统" />
            <column name="ROLE_GROUP_DEL_ENABLE" type="NVARCHAR(10)" remarks="能否删除" />
            <column name="ROLE_GROUP_PID_LIST" type="NVARCHAR(1200)" remarks="父节点列表" >
                <constraints nullable="false"/>
            </column>
            <column name="ROLE_GROUP_CHILD_COUNT" type="INT" remarks="子节点数量" />
            <column name="ROLE_GROUP_CREATER_ID" type="NVARCHAR(100)" remarks="创建者的ID" />
            <column name="ROLE_GROUP_ORGAN_ID" type="NVARCHAR(100)" remarks="创建组织ID" />
        </createTable>

        <createTable tableName="TSSO_ROLE" remarks="角色表">
            <column name="ROLE_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ROLE_KEY" type="NVARCHAR(100)" remarks="角色键值"/>
            <column name="ROLE_NAME" type="NVARCHAR(100)" remarks="角色组ID"/>
            <column name="ROLE_GROUP_ID" type="NVARCHAR(100)" remarks="角色名称"/>
            <column name="ROLE_ORDER_NUM" type="INT" remarks="排序号" />
            <column name="ROLE_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="ROLE_DESC" type="NVARCHAR(500)" remarks="备注" />
            <column name="ROLE_STATUS" type="NVARCHAR(10)" remarks="状态" />
            <column name="ROLE_CREATER_ID" type="NVARCHAR(100)" remarks="创建者的ID" />
            <column name="ROLE_ORGAN_ID" type="NVARCHAR(100)" remarks="创建组织ID" />
        </createTable>

        <createTable tableName="TSSO_USER_ROLE" remarks="角色与用户绑定表">
            <column name="BIND_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="BIND_ROLE_ID" type="NVARCHAR(100)" remarks="角色ID">
                <constraints nullable="false"/>
            </column>
            <column name="BIND_USER_ID" type="NVARCHAR(100)" remarks="角色ID">
                <constraints nullable="false"/>
            </column>
            <column name="BIND_ORDER_NUM" type="INT" remarks="排序号">
                <constraints nullable="false"/>
            </column>
            <column name="BIND_CREATE_TIME" type="datetime(6)" remarks="创建时间">
            </column>
            <column name="BIND_CREATER_ID" type="NVARCHAR(100)" remarks="创建者的ID" />
            <column name="BIND_ORGAN_ID" type="NVARCHAR(100)" remarks="组织ID" />
        </createTable>

        <!--未实现-->
        <createTable tableName="TSSO_AUTHORITY" remarks="角色权限表">
            <column name="AUTH_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ROLE_ID" type="NVARCHAR(100)" remarks="主键:UUID" />
        </createTable>

        <createTable tableName="TSSO_SSO_APP" remarks="SSO集成系统表">
            <column name="APP_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="APP_CODE" type="NVARCHAR(100)" remarks="集成系统标识键">
                <constraints nullable="false"/>
            </column>
            <column name="APP_NAME" type="NVARCHAR(100)" remarks="集成系统名称">
                <constraints nullable="false"/>
            </column>
            <column name="APP_PUBLIC_KEY" type="NVARCHAR(1000)" remarks="公钥">
            </column>
            <column name="APP_PRIVATE_KEY" type="NVARCHAR(1000)" remarks="私钥">
            </column>
            <column name="APP_DOMAIN" type="NVARCHAR(300)" remarks="域名或者ip:用于验证来源使用"></column>
            <column name="APP_INDEX_URL" type="NVARCHAR(1000)" remarks="主页的地址:用于默认登录完成之后的目标地址"></column>
            <column name="APP_INTEGRATED_TYPE" type="NVARCHAR(50)" remarks="系统的集成类型:开发集成或者模拟登录集成,模拟登录为post模拟账号进行登录"></column>
            <column name="APP_MAIN_IMAGE_ID" type="NVARCHAR(100)" remarks="主题图片ID:关联到TFS_FILE_INFO表的FILE_ID"/>
            <column name="APP_TYPE" type="NVARCHAR(50)" remarks="系统类型:主系统或者为子系统"></column>
            <column name="APP_MAIN_ID" type="NVARCHAR(50)" remarks="主系统ID:为子系统时,用于存储主系统的ID:TSSO_SSO_APP中的APP_ID"></column>
            <column name="APP_CATEGORY" type="NVARCHAR(50)" remarks="系统分类:App或者Web系统"></column>
            <column name="APP_DESC" type="NVARCHAR(500)" remarks="备注" />
            <column name="APP_ORDER_NUM" type="INT" remarks="排序号" />
            <column name="APP_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="APP_STATUS" type="NVARCHAR(10)" remarks="状态" />
            <column name="APP_CREATER_ID" type="NVARCHAR(100)" remarks="创建者的ID" />
            <column name="APP_ORGAN_ID" type="NVARCHAR(100)" remarks="创建组织ID" />
        </createTable>

        <createTable tableName="TSSO_SSO_APP_INTERFACE" remarks="SSO集成系统的接口配置表">
            <column name="INTERFACE_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="INTERFACE_BELONG_APP_ID" type="NVARCHAR(100)" remarks="所属系统ID"/>
            <column name="INTERFACE_CODE" type="NVARCHAR(100)" remarks="接口类型:默认定义和自定义:eg[LOGIN]"/>
            <column name="INTERFACE_NAME" type="NVARCHAR(100)" remarks="接口名称"/>
            <column name="INTERFACE_URL" type="NVARCHAR(1000)" remarks="接口地址"/>
            <column name="INTERFACE_PARAS" type="NVARCHAR(1000)" remarks="参数"/>
            <column name="INTERFACE_FORMAT" type="NVARCHAR(100)" remarks="格式化方法"/>
            <column name="INTERFACE_DESC" type="NVARCHAR(500)" remarks="备注" />
            <column name="INTERFACE_ORDER_NUM" type="INT" remarks="排序号" />
            <column name="INTERFACE_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="INTERFACE_STATUS" type="NVARCHAR(10)" remarks="状态" />
            <column name="INTERFACE_CREATER_ID" type="NVARCHAR(100)" remarks="创建者的ID" />
            <column name="INTERFACE_ORGAN_ID" type="NVARCHAR(100)" remarks="创建组织ID" />
        </createTable>

        <createTable tableName="TSSO_SSO_APP_FILE" remarks="SSO集成系统的相关文件表:主要用于存储模拟登录的html模拟文件">
            <column name="APP_FILE_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="APP_BELONG_APP_ID" type="NVARCHAR(100)" remarks="所属系统ID"/>
            <column name="APP_FILE_NAME" type="NVARCHAR(100)" remarks="文件名称"/>
            <column name="APP_FILE_IS_MAIN" type="NVARCHAR(100)" remarks="是否是主文件:用于Post模拟时的主执行文件"/>
            <column name="APP_FILE_DESC" type="NVARCHAR(500)" remarks="备注" />
            <column name="APP_FILE_ORDER_NUM" type="INT" remarks="排序号" />
            <column name="APP_FILE_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="APP_FILE_STATUS" type="NVARCHAR(10)" remarks="状态" />
            <column name="APP_FILE_CREATER_ID" type="NVARCHAR(100)" remarks="创建者的ID" />
            <column name="APP_FILE_ORGAN_ID" type="NVARCHAR(100)" remarks="创建组织ID" />
            <column name="APP_FILE_CNT_FILE_ID" type="NVARCHAR(100)" remarks="存储的文件ID:关联到TFS_FILE_INFO表的FILE_ID" />
        </createTable>

        <createTable tableName="TSSO_SSO_APP_USER_MAPPING" remarks="SSO集成系统的账号映射表">
            <column name="MAPPING_ID" type="NVARCHAR(100)" remarks="主键:UUID">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="MAPPING_BELONG_APP_ID" type="NVARCHAR(100)" remarks="所属系统ID" />
            <column name="MAPPING_ACCOUNT" type="NVARCHAR(100)" remarks="账号" />
            <column name="MAPPING_PASSWORD" type="NVARCHAR(100)" remarks="密码" />
            <column name="MAPPING_CREATE_TIME" type="datetime(6)" remarks="创建时间" />
            <column name="MAPPING_CREATER_ID" type="NVARCHAR(100)" remarks="创建者的ID" />
            <column name="MAPPING_ORGAN_ID" type="NVARCHAR(100)" remarks="创建组织ID" />
        </createTable>
    </changeSet>
</databaseChangeLog>
